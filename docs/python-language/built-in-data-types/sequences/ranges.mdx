---
sidebar_position: 3
---

import CodeBlock from '@theme/CodeBlock';
import ranges_1 from '!!raw-loader!/static/examples/python-language/built-in-data-types/sequences/ranges/ranges_1.py';
import ranges_2 from '!!raw-loader!/static/examples/python-language/built-in-data-types/sequences/ranges/ranges_2.py';

# Диапазоны

## Диапазоны. Общая информация {#ranges-common-information}

Тип `range` (от английского «range» — «диапазон») представляет собой неизменяемую (иммутабельную) последовательность чисел и обычно используется для выполнения цикла `for`. Объекты типа `range` инициализируются (создаются) через вызов встроенной функции-конструктора [`range()`](https://docs.python.org/3/library/functions.html#func-range).

### `class range(stop)` {#class-range-stop}
### `class range(start, stop[, step])` {#class-range-start-stop-step}

Аргументы функции-[конструктора](https://ru.wikipedia.org/wiki/Конструктор_(объектно-ориентированное_программирование)) `range()` должны быть целыми числами. Если аргумент `step` опущен, по умолчанию он равен `1`. Если аргумент `start` опущен, по умолчанию он равен `0`. Если `step` равен нулю, возбуждается исключение типа `ValueError`.

Для положительного шага (аргумент `step`) содержимое диапазона `r` определяется формулой: `r[i] = start + step * i`, где `i >= 0` и `r[i] < stop`.

Для отрицательного шага (аргумент `step`) содержимое диапазона `r` также определяется формулой `r[i] = start + step * i`, но со следующими ограничениями: `i >= 0` и `r[i] > stop`.

Объект диапазона будет пустым, если `r[0]` не соответствует заданным ограничениям. Диапазоны поддерживают отрицательные индексы, но они интерпретируются как индексация от конца последовательности, определяемой положительными индексами.

Диапазоны, содержащие значения, превышающие [`sys.maxsize`](https://docs.python.org/3/library/sys.html#sys.maxsize), допустимы, но некоторые функции (например, `len()`) при работе с этими объектами могут вызывать исключение типа `OverflowError` (ошибка переполнения).

Примеры диапазонов:

```python showLineNumbers
>>> list(range(10))
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
>>> list(range(1, 11))
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
>>> list(range(0, 30, 5))
[0, 5, 10, 15, 20, 25]
>>> list(range(0, 10, 3))
[0, 3, 6, 9]
>>> list(range(0, -10, -1))
[0, -1, -2, -3, -4, -5, -6, -7, -8, -9]
>>> list(range(0))
[]
>>> list(range(1, 0))
[]
```

Диапазоны реализуют все операции с последовательностями, кроме конкатенации (`+`) и повторения (`*`) из-за того, что объекты диапазона могут представлять только последовательности, которые следуют строгому шаблону, а повторение и объединение нарушают этот шаблон.

Преимущество типа диапазона перед списком или кортежем состоит в том, что объект диапазона всегда будет занимать один и тот же (небольшой) объем памяти, независимо от размера диапазона, который он представляет, поскольку он хранит только значения начала (аргумент `start`), остановки (аргумент `stop`) и шага (аргумент `step`), вычисляя отдельные элементы и поддиапазоны по мере необходимости.

Объекты диапазона реализуют абстрактный базовый класс [`collections.abc.Sequence`](https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence) и реализуют такие операции, как проверка включения, поиск индекса элемента, срезы и доступ к элементам по отрицательным индексам:

```python showLineNumbers
>>> r = range(0, 20, 2)
>>> r
range(0, 20, 2)
>>> 11 in r
False
>>> 10 in r
True
>>> r.index(10)
5
>>> r[5]
10
>>> r[:5]
range(0, 10, 2)
>>> r[-1]
18
```

Проверка объектов диапазона на равенство с помощью операторов `==` и `!=` сравнивает их как последовательности. То есть два объекта диапазона считаются равными, если они представляют одну и ту же последовательность значений.

:::info внимание

Два объекта диапазона, которые при сравнении будут считаться равными (операция `==` вернёт `True`), могут иметь разные значения свойств `start`, `stop` и `step`, например `range(0) == range(2, 1, 3)` или `range(0, 3, 2) == range(0, 4, 2)`.

:::

### Использование диапазонов совместно с циклом `for` {#ranges-and-for-statement}

Тип `range` специально создавался для использования совместно с циклом `for`.

<CodeBlock language="python" title="ranges_1.py" showLineNumbers>{ranges_1}</CodeBlock>

В примере 1 приведено два варианта задания цикла с пятью итерациями.

Первый вариант — строки 5, 6 и 7 — с использованием цикла `while`.

Второй вариант — строки 18 и 19 — с использованием цикла `for` и объекта `range`.

Объект типа `range` создаётся в выражении `range(5)`. Цикл `for` проходит по итератору, который был создан на основе объекта типа `range`.

:::info внимание

При использовании в цикле `while` переменная `i` на последней итерации равна `5`. А на при использовании в цикле `for` переменная `i` на последней итерации равна `4`.

Мы удаляем переменную `i` после каждого использования совместно с циклом, чтобы исключить возможную смысловую ошибку, которая могла бы возникнуть, если бы мы где-то ниже в программе решили использовать переменную с именем `i`.

:::

<CodeBlock language="python" title="ranges_2.py" showLineNumbers>{ranges_2}</CodeBlock>

## Дополнительные ссылки {#additional-links}

- [Экранирование символов](https://ru.wikipedia.org/wiki/Экранирование_символов)
- [Управляющие символы](https://ru.wikipedia.org/wiki/Управляющие_символы)
- [Переносимый набор символов](https://ru.wikipedia.org/wiki/Переносимый_набор_символов)
- [Конструктор (объектно-ориентированное программирование)](https://ru.wikipedia.org/wiki/Конструктор_(объектно-ориентированное_программирование))
